javascript:(async()=>{const s=t=>new Promise(r=>setTimeout(r,t)),w=(xp,t=1e4)=>new Promise((res,rej)=>{const st=Date.now();(function ck(){const e=document.evaluate(xp,document,null,9,null).singleNodeValue;if(e)return res(e);if(Date.now()-st>t){console.warn("Timeout:",xp);location.reload();return rej()}setTimeout(ck,200)})()}),f=(xp,v)=>{const e=document.evaluate(xp,document,null,9,null).singleNodeValue;if(!e)return;Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value").set.call(e,v);e.dispatchEvent(new Event("input",{bubbles:1}));e.dispatchEvent(new Event("change",{bubbles:1}))},c=e=>{if(e)try{e.click()}catch{e.dispatchEvent(new MouseEvent("click",{bubbles:1,cancelable:1,view:window}))}},cx=async xp=>c(await w(xp));try{const L=await w("//span[contains(text(),'Leverage ')]"),ok=document.evaluate("//span[text()='Leverage 11X']",document,null,9,null).singleNodeValue;if(!ok){L.click();await w("//span[text()='25X']");f('//span[text()="Leverage"]/../../input',"11");(await w("//button[text()='Confirm']")).click();try{await w("//span[text()='Editing successful']",5e3)}catch{location.reload()}}await s(1e3)}catch(e){console.error("Lỗi bước 1:",e)}try{const x=xp=>document.evaluate(xp,document,null,9,null).singleNodeValue,ss=ms=>new Promise(r=>setTimeout(r,ms)),cl=e=>e&&(e.click?.()||e.dispatchEvent(new MouseEvent("click",{bubbles:1,cancelable:1,view:window})));const fb=x("//span[text()='Flash close']");if(fb){cl(fb);let cb,st=Date.now();while(!(cb=x("//button[text()='Confirm']"))&&Date.now()-st<1e4)await ss(100);cb&&cl(cb)}}catch(e){console.error("Lỗi bước 3:",e)}try{const ws=(xp,t=5e3)=>new Promise((res,rej)=>{const st=Date.now(),i=setInterval(()=>{const n=document.evaluate(xp,document,null,9,null).singleNodeValue;if(n){clearInterval(i);res(n)}if(Date.now()-st>t){clearInterval(i);rej()}},100)}),cs=xp=>{const e=document.evaluate(xp,document,null,9,null).singleNodeValue;e&&e.click()};cs("//div[text()='Order details']");await ws("//div[@class='bit-table-body']//tbody");await s(300);const fo=document.evaluate("//div[@class='bit-table-body']//span[normalize-space(text())='Open long']",document,null,9,null).singleNodeValue;if(!fo){cs("//span[contains(text(),'Positions')]");try{const z=document.evaluate("//span[contains(text(),'Available')]/../span[text()='0.0000 USDT']",document,null,9,null).singleNodeValue;if(z){z.parentElement.parentElement.querySelector("div button").click();const[ab,cb]=await Promise.all([w("//span[text()='All']"),w("//button[text()='Confirm']")]);setTimeout(()=>ab.click(),1e3);setTimeout(()=>cb.click(),2e3);await w("//span[text()='Successful transfer']",1e4);await s(2e3)}}catch(e){console.warn("Lỗi bước 2:",e);location.reload()}try{await cx("//span[text()='Market']");await w("//span[text()='To be executed at the best price']");const pEl=await w('//div[contains(@class,"CurrentPriceDisplay")]/div/span');let p=parseFloat(pEl.textContent.replace(/,/g,"").trim());if(isNaN(p))throw 0;p=Math.floor(p);const q=Math.max(.001,Math.ceil(((2e3/2)/p)*1e3-1e-12)/1e3);f('//input[@name="op-amount"]',q);await cx("//span[text()='Open long']");await w("//button[text()='Confirm']");await cx("//button[text()='Confirm']");await w("//span[text()='Flash close']");await cx("//span[text()='Flash close']");await w("//button[text()='Confirm']");await cx("//button[text()='Confirm']")}catch(e){console.error("Lỗi bước 5:",e)}}}catch(e){console.error("Lỗi bước 4:",e)}await s(2e3);try{const z=document.evaluate("//span[contains(text(),'Available')]/../span[text()='0.0000 USDT']",document,null,9,null).singleNodeValue;if(z){prompt("DONE ✅")}else{const b=document.evaluate("//span[contains(text(),'Available')]/../../div/button",document,null,9,null).singleNodeValue;b&&b.click();const ab=await w("//span[text()='All']"),ti=await w("//div[text()='Transfer']/../div/div/div/i"),cb=await w("//button[text()='Confirm']");setTimeout(()=>{ti.click();setTimeout(()=>{ab.click();setTimeout(()=>{cb.click();(async()=>{try{await w("//span[contains(text(),'Available')]/../span[text()='0.0000 USDT']",2e3);await s(1e3);prompt("DONE ✅")}catch{location.reload()}})()},1e3)},1e3)},1e3)}}catch(e){console.error("Lỗi bước 6:",e)}})();
